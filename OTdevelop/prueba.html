<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>calendar prueba</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
</head>
<body>

</body>
<script>
fielderCamp = JSON.stringify([{id: 171,idCr: 27,idFielder: 7,createAt: 1460135250504,accion: null,campana: {id: 57,tcode: "000000002",campaigncode: "CA00000002",offercode: "P00000002",titulo: "FINANCIAMIENTOS TIENDA TELMEX",descripcion: "VISITA TU TIENDA TELMEX",createAt: "2016-02-04",estado: true,deleteAt: null,imagen: "banner_LB_720x640.jpg",color: "b4a7d6",fechaInicio: "2016-03-27",fechaFin: "2016-04-21"},campReg: [{id: 27,idCampa√±a: 57,region: "1-4-0-0",createAt: "2016-04-04",estado: true,deleteAt: null}]}]);
	localStorage.setItem('fielderCamp',fielderCamp); 
	fielderCamp = JSON.parse(localStorage.getItem('fielderCamp'));
document.addEventListener('DOMContentLoaded', function() {
   calendar();
});
function calendar(){
a = '2016-03-27';//findLoop(fielderCamp,'fechaInicio');
b = '2016-04-21';//findLoop(fielderCamp, 'fechaFin');
//calendario
  splitInicio = a.split('-'),
        splitFinal = b.split('-'),
        oneDay = 24*60*60*1000,
        firstDate = new Date(splitInicio[0],splitInicio[1],splitInicio[2]),
        secondDate = new Date(splitFinal[0],splitFinal[1],splitFinal[2]),
        diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay))),
        //perDay = parseInt(r[i].calendario.meta)/parseInt(diffDays),
        mm = splitInicio[1]-1, 
        yy = splitInicio[2], 
        changeMonth = 0;
        console.log("diferencia de dias: "+diffDays);
        for(var f = 0; f <= diffDays;){
          monthLength = new Date(yy, mm+1, 0).getDate();
          console.log("duracion del mes: "+monthLength);
          for (a = 1; a <= monthLength; a++){
            if(changeMonth == 0){
              if(mm == splitInicio[1]-1){
                a = splitInicio[0];
                diffDays - parseInt(a);
                changeMonth++;
              }
            }
            if(a == parseInt(splitFinal[0])+1){
              patt = /^0[0-9].*$/, 
              monthNum = parseInt(splitFinal[1])-1;
              if(patt.test(monthNum)){
                  var mmParse = monthNum.toString().split('');
                  if(mm == mmParse[1]){
                    break;
                  }
              }
              else{
                if(mm == monthNum){
                  break;
                }     
              }

            }
            //if(!fielderCalendar){
            	fielderCalendar = {};
            //}
            if(!fielderCalendar[yy]){
              fielderCalendar[yy] ={};
            }
            if(!fielderCalendar[yy][mm]){
              fielderCalendar[yy][mm] = {};
            }
            if(fielderCalendar[yy][mm][a]){
              newObj = fielderCalendar[yy][mm][a];
                if(!newObj.asignacion){
                  newObj.asignacion = {};
                  newObj.asignacion[ObjectSize(newObj.asignacion)]={};
                  //newObj.asignacion[ObjectSize(newObj.asignacion)-1]["clientes"] = {}
                }
                if(!newObj.campInfo){
                 /* newObj.campInfo = [],
                  newObj.campInfo[0] = {}, 
                  newObj.campInfo[0]["idCr"] = r[i].idCalendar,
                  newObj.campInfo[0]["idCamp"] = r[i].camp.id,
                  newObj.campInfo[0]["color"] = r[i].camp.color,
                  newObj.campInfo[0]["meta"] = {},
                  newObj.campInfo[0].meta.meta = r[i].calendario.meta, 
                  newObj.campInfo[0].meta.visitas = 0,
                  newObj.campInfo[0].meta.ventas = 0;*/
                }
                if(newObj.campInfo){
                  /*newObj.campInfo[newObj.campInfo.length] = {}, 
                  newObj.campInfo[newObj.campInfo.length-1]["idCr"] = r[i].idCalendar,
                  newObj.campInfo[newObj.campInfo.length-1]["idCamp"] = r[i].camp.id,
                  newObj.campInfo[newObj.campInfo.length-1]["color"] = r[i].camp.color,
                  newObj.campInfo[newObj.campInfo.length-1]["meta"] = {},
                  newObj.campInfo[newObj.campInfo.length-1].meta.meta = r[i].calendario.meta, 
                  newObj.campInfo[newObj.campInfo.length-1].meta.visitas = 0,
                  newObj.campInfo[newObj.campInfo.length-1].meta.ventas = 0; */
                }
            }
            if(!fielderCalendar[yy][mm][a]){
             /* fielderCalendar[yy][mm][a] = {};
              newObj = fielderCalendar[yy][mm][a],
              newObj.asignacion = {},
              newObj.asignacion[ObjectSize(newObj.asignacion)]={},
              newObj.asignacion[ObjectSize(newObj.asignacion)-1]["clientes"] = {},
              newObj.campInfo = [],
              newObj.campInfo[0] = {}, 
              newObj.campInfo[0]["idCr"] = r[i].idCalendar,
              newObj.campInfo[0]["idCamp"] = r[i].camp.id,
              newObj.campInfo[0]["color"] = r[i].camp.color,
              newObj.campInfo[0]["meta"] = {},
              newObj.campInfo[0].meta.meta = r[i].calendario.meta, 
              newObj.campInfo[0].meta.visitas = 0,
              newObj.campInfo[0].meta.ventas = 0;*/
            }
            if(a == monthLength){
              mm++;
            }
            if(mm == 12){
              yy++;
              mm = 0;
            }
            console.log(a);
            f++;
          }
        }
      




}











function findLoop(a,f){
	$.each(a, function(index, val) {
		if(index == f){
			return 'string(val)';
		}
		else{
			if(typeof(val) != 'string' && typeof(val) != 'number' && val != null && val != undefined && val != true && val != false){
				findLoop(val,f);
			}
		}
	});
}
</script>
</html>
